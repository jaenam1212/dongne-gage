{
    "sourceFile": "components/customer/product-card.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1770983023568,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1770983150064,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -24,11 +24,12 @@\n   if (product.max_quantity === null) return false\n   return product.reserved_count >= product.max_quantity\n }\n \n+/** 재고 문구. max_quantity만 사용 (1인당 제한과 혼동 금지) */\n function getRemainingText(product: Product): string {\n-  if (product.max_quantity === null) return '무제한'\n-  const remaining = product.max_quantity - product.reserved_count\n+  if (product.max_quantity == null) return '무제한'\n+  const remaining = Number(product.max_quantity) - Number(product.reserved_count ?? 0)\n   if (remaining <= 0) return '매진'\n   return `${remaining}개 남음`\n }\n \n"
                }
            ],
            "date": 1770983023568,
            "name": "Commit-0",
            "content": "import Link from 'next/link'\nimport { Clock, Package, ShoppingBag } from 'lucide-react'\nimport { formatKoreanWon } from '@/lib/utils'\n\ninterface Product {\n  id: string\n  title: string\n  description: string | null\n  price: number\n  image_url: string | null\n  max_quantity: number | null\n  max_quantity_per_customer?: number | null\n  reserved_count: number\n  deadline: string | null\n  is_active: boolean\n}\n\nfunction isExpired(deadline: string | null): boolean {\n  if (!deadline) return false\n  return new Date(deadline) < new Date()\n}\n\nfunction isSoldOut(product: Product): boolean {\n  if (product.max_quantity === null) return false\n  return product.reserved_count >= product.max_quantity\n}\n\nfunction getRemainingText(product: Product): string {\n  if (product.max_quantity === null) return '무제한'\n  const remaining = product.max_quantity - product.reserved_count\n  if (remaining <= 0) return '매진'\n  return `${remaining}개 남음`\n}\n\nfunction formatDeadline(deadline: string): string {\n  const d = new Date(deadline)\n  const month = d.getMonth() + 1\n  const day = d.getDate()\n  const hours = d.getHours().toString().padStart(2, '0')\n  const minutes = d.getMinutes().toString().padStart(2, '0')\n  return `${month}/${day} ${hours}:${minutes} 마감`\n}\n\nexport function ProductCard({\n  product,\n  shopSlug,\n}: {\n  product: Product\n  shopSlug: string\n}) {\n  const expired = isExpired(product.deadline)\n  const soldOut = isSoldOut(product)\n  const unavailable = expired || soldOut\n\n  return (\n    <div\n      className={`group relative overflow-hidden rounded-2xl border bg-white shadow-sm transition-all duration-300 ${\n        unavailable\n          ? 'border-stone-200 opacity-70'\n          : 'border-stone-200 hover:border-stone-300 hover:shadow-md'\n      }`}\n    >\n      <div className=\"relative aspect-[4/3] overflow-hidden bg-stone-100\">\n        {product.image_url ? (\n          <img\n            src={product.image_url}\n            alt={product.title}\n            className={`h-full w-full object-cover transition-transform duration-500 ${\n              unavailable ? '' : 'group-hover:scale-105'\n            }`}\n          />\n        ) : (\n          <div className=\"flex h-full items-center justify-center\">\n            <Package className=\"h-12 w-12 text-stone-300\" />\n          </div>\n        )}\n\n        {soldOut && (\n          <div className=\"absolute inset-0 flex items-center justify-center bg-black/40\">\n            <span className=\"rounded-full bg-red-500 px-5 py-2 text-sm font-bold text-white shadow-lg\">\n              매진\n            </span>\n          </div>\n        )}\n        {expired && !soldOut && (\n          <div className=\"absolute inset-0 flex items-center justify-center bg-black/40\">\n            <span className=\"inline-flex items-center gap-1.5 rounded-full bg-stone-700 px-5 py-2 text-sm font-bold text-white shadow-lg\">\n              <Clock className=\"h-4 w-4\" />\n              마감\n            </span>\n          </div>\n        )}\n      </div>\n\n      <div className=\"p-4\">\n        <h3 className=\"text-base font-bold text-stone-900 leading-snug\">\n          {product.title}\n        </h3>\n        {product.description && (\n          <p className=\"mt-1 text-sm text-stone-500 line-clamp-2 leading-relaxed\">\n            {product.description}\n          </p>\n        )}\n\n        <div className=\"mt-3 flex items-end justify-between\">\n          <div>\n            <p className=\"text-lg font-extrabold text-stone-900 tracking-tight\">\n              {formatKoreanWon(product.price)}\n            </p>\n            <div className=\"mt-1 flex flex-col gap-0.5 text-xs text-stone-400\">\n              <span\n                className={\n                  soldOut\n                    ? 'font-semibold text-red-500'\n                    : product.max_quantity !== null &&\n                      product.max_quantity - product.reserved_count <= 3\n                    ? 'font-semibold text-amber-600'\n                    : ''\n                }\n              >\n                재고 {getRemainingText(product)}\n              </span>\n              {product.max_quantity_per_customer != null && (\n                <span>1인당 최대 {product.max_quantity_per_customer}개</span>\n              )}\n              {product.deadline && !expired && (\n                <span>{formatDeadline(product.deadline)}</span>\n              )}\n            </div>\n          </div>\n\n          {!unavailable && (\n            <Link\n              href={`/${shopSlug}/reserve/${product.id}`}\n              className=\"inline-flex items-center gap-1.5 rounded-xl bg-stone-900 px-4 py-2.5 text-sm font-semibold text-white transition-colors hover:bg-stone-800 active:bg-stone-950 min-h-[44px]\"\n            >\n              <ShoppingBag className=\"h-4 w-4\" />\n              예약하기\n            </Link>\n          )}\n        </div>\n      </div>\n    </div>\n  )\n}\n"
        }
    ]
}