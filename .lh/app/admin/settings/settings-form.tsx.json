{
    "sourceFile": "app/admin/settings/settings-form.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1770979969126,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1770979969126,
            "name": "Commit-0",
            "content": "'use client'\n\nimport { useState, useRef } from 'react'\nimport { updateShop } from './actions'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { Textarea } from '@/components/ui/textarea'\nimport { ImagePlus, Check, Loader2 } from 'lucide-react'\nimport toast, { Toaster } from 'react-hot-toast'\n\ninterface Shop {\n  id: string\n  name: string\n  slug: string\n  description: string | null\n  phone: string | null\n  address: string | null\n  logo_url: string | null\n  kakao_channel_url: string | null\n}\n\nexport function SettingsForm({ shop }: { shop: Shop | null }) {\n  const [loading, setLoading] = useState(false)\n  const [previewUrl, setPreviewUrl] = useState<string | null>(shop?.logo_url ?? null)\n  const fileInputRef = useRef<HTMLInputElement>(null)\n\n  function handleFileChange(e: React.ChangeEvent<HTMLInputElement>) {\n    const file = e.target.files?.[0]\n    if (file) {\n      setPreviewUrl(URL.createObjectURL(file))\n    }\n  }\n\n  async function handleSubmit(formData: FormData) {\n    setLoading(true)\n    try {\n      const result = await updateShop(formData)\n      if (result.success) {\n        toast.success('가게 정보가 저장되었습니다')\n      }\n    } catch {\n      toast.error('저장에 실패했습니다. 다시 시도해주세요.')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  return (\n    <>\n      <Toaster\n        position=\"top-center\"\n        toastOptions={{\n          className: 'text-sm font-medium',\n          duration: 3000,\n        }}\n      />\n      <form action={handleSubmit} className=\"space-y-5\">\n        <input type=\"hidden\" name=\"current_logo_url\" value={shop?.logo_url ?? ''} />\n\n        {shop?.slug && (\n          <div className=\"rounded-2xl border border-stone-200 bg-stone-50 p-5\">\n            <p className=\"text-xs font-medium text-stone-500\">고객이 들어가는 URL</p>\n            <p className=\"mt-1 text-sm font-semibold text-stone-900 break-all\">\n              {process.env.NEXT_PUBLIC_SITE_URL || 'https://dongnegage.com'}/{shop.slug}\n            </p>\n          </div>\n        )}\n\n        <div className=\"rounded-2xl border border-stone-200 bg-white p-5 shadow-sm space-y-5\">\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"name\" className=\"text-stone-700\">\n              가게명\n            </Label>\n            <Input\n              id=\"name\"\n              name=\"name\"\n              defaultValue={shop?.name ?? ''}\n              required\n              placeholder=\"가게 이름을 입력하세요\"\n              className=\"border-stone-200 bg-stone-50 focus-visible:ring-stone-400\"\n            />\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"description\" className=\"text-stone-700\">\n              설명\n            </Label>\n            <Textarea\n              id=\"description\"\n              name=\"description\"\n              defaultValue={shop?.description ?? ''}\n              placeholder=\"가게에 대한 간단한 소개\"\n              rows={3}\n              className=\"border-stone-200 bg-stone-50 focus-visible:ring-stone-400 resize-none\"\n            />\n          </div>\n\n          <div className=\"grid grid-cols-1 gap-5 sm:grid-cols-2\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"phone\" className=\"text-stone-700\">\n                전화번호\n              </Label>\n              <Input\n                id=\"phone\"\n                name=\"phone\"\n                defaultValue={shop?.phone ?? ''}\n                placeholder=\"02-1234-5678\"\n                className=\"border-stone-200 bg-stone-50 focus-visible:ring-stone-400\"\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"address\" className=\"text-stone-700\">\n                주소\n              </Label>\n              <Input\n                id=\"address\"\n                name=\"address\"\n                defaultValue={shop?.address ?? ''}\n                placeholder=\"서울시 강남구...\"\n                className=\"border-stone-200 bg-stone-50 focus-visible:ring-stone-400\"\n              />\n            </div>\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label className=\"text-stone-700\">로고 이미지</Label>\n            <div className=\"flex items-center gap-4\">\n              <button\n                type=\"button\"\n                onClick={() => fileInputRef.current?.click()}\n                className=\"flex h-20 w-20 shrink-0 items-center justify-center rounded-xl border-2 border-dashed border-stone-200 bg-stone-50 hover:border-stone-300 hover:bg-stone-100 transition-colors overflow-hidden\"\n              >\n                {previewUrl ? (\n                  <img\n                    src={previewUrl}\n                    alt=\"로고 미리보기\"\n                    className=\"h-full w-full object-cover\"\n                  />\n                ) : (\n                  <ImagePlus className=\"h-6 w-6 text-stone-400\" />\n                )}\n              </button>\n              <div className=\"text-xs text-stone-400\">\n                <p>클릭하여 로고를 업로드하세요</p>\n                <p>JPG, PNG (최대 2MB)</p>\n              </div>\n            </div>\n            <input\n              ref={fileInputRef}\n              type=\"file\"\n              name=\"logo\"\n              accept=\"image/*\"\n              onChange={handleFileChange}\n              className=\"hidden\"\n            />\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"kakao_channel_url\" className=\"text-stone-700\">\n              카카오 채널 URL\n            </Label>\n            <Input\n              id=\"kakao_channel_url\"\n              name=\"kakao_channel_url\"\n              defaultValue={shop?.kakao_channel_url ?? ''}\n              placeholder=\"https://pf.kakao.com/...\"\n              className=\"border-stone-200 bg-stone-50 focus-visible:ring-stone-400\"\n            />\n          </div>\n        </div>\n\n        <Button\n          type=\"submit\"\n          disabled={loading}\n          className=\"h-11 w-full bg-stone-900 text-white hover:bg-stone-800 transition-colors sm:w-auto sm:px-8\"\n        >\n          {loading ? (\n            <>\n              <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n              저장 중...\n            </>\n          ) : (\n            <>\n              <Check className=\"mr-2 h-4 w-4\" />\n              저장\n            </>\n          )}\n        </Button>\n      </form>\n    </>\n  )\n}\n"
        }
    ]
}