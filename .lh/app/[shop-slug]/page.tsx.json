{
    "sourceFile": "app/[shop-slug]/page.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 3,
            "patches": [
                {
                    "date": 1770981473376,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1770982396942,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,8 +2,9 @@\n import { notFound } from 'next/navigation'\n import { createClient } from '@/lib/supabase/server'\n import { ProductCard } from '@/components/customer/product-card'\n import { PwaTutorialLink } from '@/components/customer/pwa-tutorial-link'\n+import { PushSubscribeButton } from '@/components/customer/push-subscribe-button'\n import { Store, Phone } from 'lucide-react'\n \n interface Props {\n   params: Promise<{ 'shop-slug': string }>\n@@ -101,8 +102,9 @@\n                 {shop.phone}\n               </div>\n             )}\n             <PwaTutorialLink shopSlug={slug} />\n+            <PushSubscribeButton shopId={shop.id} shopSlug={slug} />\n           </div>\n         </div>\n       </header>\n \n"
                },
                {
                    "date": 1770983023654,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -23,9 +23,9 @@\n   if (!shop) return null\n \n   const { data: products } = await supabase\n     .from('products')\n-    .select('id, title, description, price, image_url, max_quantity, reserved_count, deadline, is_active')\n+    .select('id, title, description, price, image_url, max_quantity, max_quantity_per_customer, reserved_count, deadline, is_active')\n     .eq('shop_id', shop.id)\n     .eq('is_active', true)\n     .order('created_at', { ascending: false })\n \n"
                },
                {
                    "date": 1770983888160,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,9 +3,10 @@\n import { createClient } from '@/lib/supabase/server'\n import { ProductCard } from '@/components/customer/product-card'\n import { PwaTutorialLink } from '@/components/customer/pwa-tutorial-link'\n import { PushSubscribeButton } from '@/components/customer/push-subscribe-button'\n-import { Store, Phone } from 'lucide-react'\n+import Link from 'next/link'\n+import { Store, Phone, ShoppingBag } from 'lucide-react'\n \n interface Props {\n   params: Promise<{ 'shop-slug': string }>\n }\n@@ -95,8 +96,15 @@\n               )}\n             </div>\n           </div>\n           <div className=\"mt-4 flex flex-wrap items-center gap-2\">\n+            <Link\n+              href=\"/my-orders\"\n+              className=\"inline-flex items-center gap-2 rounded-lg bg-stone-50 px-3 py-1.5 text-sm text-stone-600 hover:bg-stone-100 hover:text-stone-800 transition-colors\"\n+            >\n+              <ShoppingBag className=\"h-3.5 w-3.5\" />\n+              내 주문 내역\n+            </Link>\n             {shop.phone && (\n               <div className=\"inline-flex items-center gap-2 rounded-lg bg-stone-50 px-3 py-1.5 text-sm text-stone-600\">\n                 <Phone className=\"h-3.5 w-3.5\" />\n                 {shop.phone}\n"
                }
            ],
            "date": 1770981473376,
            "name": "Commit-0",
            "content": "import type { Metadata } from 'next'\nimport { notFound } from 'next/navigation'\nimport { createClient } from '@/lib/supabase/server'\nimport { ProductCard } from '@/components/customer/product-card'\nimport { PwaTutorialLink } from '@/components/customer/pwa-tutorial-link'\nimport { Store, Phone } from 'lucide-react'\n\ninterface Props {\n  params: Promise<{ 'shop-slug': string }>\n}\n\nasync function getShopWithProducts(slug: string) {\n  const supabase = await createClient()\n\n  const { data: shop } = await supabase\n    .from('shops')\n    .select('id, slug, name, description, phone, logo_url')\n    .eq('slug', slug)\n    .eq('is_active', true)\n    .single()\n\n  if (!shop) return null\n\n  const { data: products } = await supabase\n    .from('products')\n    .select('id, title, description, price, image_url, max_quantity, reserved_count, deadline, is_active')\n    .eq('shop_id', shop.id)\n    .eq('is_active', true)\n    .order('created_at', { ascending: false })\n\n  return { shop, products: products || [] }\n}\n\nexport async function generateMetadata({ params }: Props): Promise<Metadata> {\n  const { 'shop-slug': slug } = await params\n  const data = await getShopWithProducts(slug)\n\n  if (!data) {\n    return { title: '페이지를 찾을 수 없습니다' }\n  }\n\n  const { shop } = data\n  const baseUrl = process.env.NEXT_PUBLIC_SITE_URL || 'https://dongnegage.com'\n\n  return {\n    title: `${shop.name} - 동네 가게`,\n    description: shop.description || `${shop.name}에서 예약하세요`,\n    openGraph: {\n      title: shop.name,\n      description: shop.description || `${shop.name}에서 예약하세요`,\n      url: `${baseUrl}/${shop.slug}`,\n      siteName: '동네 가게',\n      images: shop.logo_url ? [{ url: shop.logo_url, width: 1200, height: 630 }] : [],\n      type: 'website',\n      locale: 'ko_KR',\n    },\n    twitter: {\n      card: 'summary_large_image',\n      title: shop.name,\n      description: shop.description || `${shop.name}에서 예약하세요`,\n    },\n  }\n}\n\nexport default async function ShopPage({ params }: Props) {\n  const { 'shop-slug': slug } = await params\n  const data = await getShopWithProducts(slug)\n\n  if (!data) notFound()\n\n  const { shop, products } = data\n\n  return (\n    <div className=\"min-h-dvh bg-stone-50\">\n      <header className=\"relative overflow-hidden border-b border-stone-200 bg-white\">\n        <div className=\"absolute inset-0 bg-gradient-to-br from-stone-100 via-white to-stone-50\" />\n        <div className=\"relative mx-auto max-w-2xl px-4 py-8 md:py-12\">\n          <div className=\"flex items-center gap-4\">\n            {shop.logo_url ? (\n              <img\n                src={shop.logo_url}\n                alt={shop.name}\n                className=\"h-14 w-14 rounded-2xl object-cover shadow-sm border border-stone-200\"\n              />\n            ) : (\n              <div className=\"flex h-14 w-14 items-center justify-center rounded-2xl bg-stone-900 shadow-sm\">\n                <Store className=\"h-6 w-6 text-white\" />\n              </div>\n            )}\n            <div>\n              <h1 className=\"text-xl font-bold text-stone-900 md:text-2xl\">{shop.name}</h1>\n              {shop.description && (\n                <p className=\"mt-0.5 text-sm text-stone-500\">{shop.description}</p>\n              )}\n            </div>\n          </div>\n          <div className=\"mt-4 flex flex-wrap items-center gap-2\">\n            {shop.phone && (\n              <div className=\"inline-flex items-center gap-2 rounded-lg bg-stone-50 px-3 py-1.5 text-sm text-stone-600\">\n                <Phone className=\"h-3.5 w-3.5\" />\n                {shop.phone}\n              </div>\n            )}\n            <PwaTutorialLink shopSlug={slug} />\n          </div>\n        </div>\n      </header>\n\n      <main className=\"mx-auto max-w-2xl px-4 py-6 md:py-8\">\n        {products.length === 0 ? (\n          <div className=\"rounded-2xl border border-stone-200 bg-white py-16 text-center shadow-sm\">\n            <Store className=\"mx-auto h-10 w-10 text-stone-300\" />\n            <p className=\"mt-3 text-sm text-stone-400\">현재 등록된 상품이 없습니다</p>\n          </div>\n        ) : (\n          <div className=\"grid gap-4 md:grid-cols-2\">\n            {products.map((product) => (\n              <ProductCard\n                key={product.id}\n                product={product}\n                shopSlug={slug}\n              />\n            ))}\n          </div>\n        )}\n      </main>\n\n      <footer className=\"border-t border-stone-100 py-6 text-center text-xs text-stone-400\">\n        <p>동네 가게 · 우리 동네 예약 서비스</p>\n      </footer>\n    </div>\n  )\n}\n"
        }
    ]
}