{
    "sourceFile": "app/signup/page.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1770979863861,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1770980104281,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -16,14 +16,18 @@\n   const [shopName, setShopName] = useState('')\n   const [suggestedSlug, setSuggestedSlug] = useState('')\n   const [error, setError] = useState<string | null>(null)\n \n+  // 가게 URL은 영문 소문자, 숫자, 하이픈만 허용 (한글 불가)\n   function generateSlug(name: string): string {\n-    return name\n+    const raw = name\n       .toLowerCase()\n       .replace(/\\s+/g, '-')\n-      .replace(/[^a-z0-9\\-가-힣]/g, '')\n+      .replace(/[^a-z0-9\\-]/g, '')\n+      .replace(/-+/g, '-')\n+      .replace(/^-|-$/g, '')\n       .slice(0, 50)\n+    return raw || 'shop'\n   }\n \n   function handleShopNameChange(e: React.ChangeEvent<HTMLInputElement>) {\n     const name = e.target.value\n@@ -124,14 +128,17 @@\n                   id=\"slug\"\n                   name=\"slug\"\n                   required\n                   value={suggestedSlug}\n-                  onChange={(e) => setSuggestedSlug(e.target.value)}\n-                  placeholder=\"shop-url\"\n+                  onChange={(e) => {\n+                    const v = e.target.value.toLowerCase().replace(/[^a-z0-9\\-]/g, '')\n+                    setSuggestedSlug(v)\n+                  }}\n+                  placeholder=\"my-shop\"\n                   className=\"border-stone-200 bg-stone-50 focus-visible:ring-stone-400\"\n                 />\n                 <p className=\"text-xs text-stone-400\">\n-                  고객이 접속할 URL: dongnegage.com/{suggestedSlug || 'your-shop'}\n+                  영문 소문자, 숫자, 하이픈(-)만 사용 가능 · dongnegage.com/{suggestedSlug || 'my-shop'}\n                 </p>\n               </div>\n \n               <div className=\"space-y-2\">\n"
                }
            ],
            "date": 1770979863861,
            "name": "Commit-0",
            "content": "'use client'\n\nimport { useState } from 'react'\nimport { useRouter } from 'next/navigation'\nimport Link from 'next/link'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { Loader2, ArrowLeft } from 'lucide-react'\nimport { signUp } from './actions'\nimport toast, { Toaster } from 'react-hot-toast'\n\nexport default function SignupPage() {\n  const router = useRouter()\n  const [loading, setLoading] = useState(false)\n  const [shopName, setShopName] = useState('')\n  const [suggestedSlug, setSuggestedSlug] = useState('')\n  const [error, setError] = useState<string | null>(null)\n\n  function generateSlug(name: string): string {\n    return name\n      .toLowerCase()\n      .replace(/\\s+/g, '-')\n      .replace(/[^a-z0-9\\-가-힣]/g, '')\n      .slice(0, 50)\n  }\n\n  function handleShopNameChange(e: React.ChangeEvent<HTMLInputElement>) {\n    const name = e.target.value\n    setShopName(name)\n    if (name.trim()) {\n      setSuggestedSlug(generateSlug(name))\n    } else {\n      setSuggestedSlug('')\n    }\n  }\n\n  async function handleSubmit(e: React.FormEvent<HTMLFormElement>) {\n    e.preventDefault()\n    setLoading(true)\n    setError(null)\n\n    const formData = new FormData(e.currentTarget)\n    const result = await signUp(formData)\n\n    if (result?.error) {\n      setError(result.error)\n      toast.error(result.error)\n      setLoading(false)\n    } else {\n      toast.success('가입이 완료되었습니다!')\n      router.push('/admin/dashboard')\n    }\n  }\n\n  return (\n    <>\n      <Toaster position=\"top-center\" toastOptions={{ className: 'text-sm font-medium', duration: 3000 }} />\n\n      <div className=\"min-h-dvh bg-stone-50 flex items-center justify-center px-4 py-12\">\n        <div className=\"w-full max-w-md\">\n          <Link\n            href=\"/\"\n            className=\"inline-flex items-center gap-2 text-sm text-stone-500 hover:text-stone-700 transition-colors mb-6\"\n          >\n            <ArrowLeft className=\"h-4 w-4\" />\n            홈으로 돌아가기\n          </Link>\n\n          <div className=\"rounded-2xl border border-stone-200 bg-white p-8 shadow-sm\">\n            <h1 className=\"text-2xl font-bold text-stone-900\">가입하기</h1>\n            <p className=\"mt-2 text-sm text-stone-500\">\n              5분이면 충분합니다\n            </p>\n\n            {error && (\n              <div className=\"mt-4 rounded-xl border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-700\">\n                {error}\n              </div>\n            )}\n\n            <form onSubmit={handleSubmit} className=\"mt-6 space-y-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"email\">이메일 <span className=\"text-red-500\">*</span></Label>\n                <Input\n                  id=\"email\"\n                  name=\"email\"\n                  type=\"email\"\n                  required\n                  placeholder=\"your@email.com\"\n                  className=\"border-stone-200 bg-stone-50 focus-visible:ring-stone-400\"\n                />\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"password\">비밀번호 <span className=\"text-red-500\">*</span></Label>\n                <Input\n                  id=\"password\"\n                  name=\"password\"\n                  type=\"password\"\n                  required\n                  minLength={8}\n                  placeholder=\"최소 8자\"\n                  className=\"border-stone-200 bg-stone-50 focus-visible:ring-stone-400\"\n                />\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"shopName\">가게 이름 <span className=\"text-red-500\">*</span></Label>\n                <Input\n                  id=\"shopName\"\n                  name=\"shopName\"\n                  required\n                  value={shopName}\n                  onChange={handleShopNameChange}\n                  placeholder=\"예: 테스트 정육점\"\n                  className=\"border-stone-200 bg-stone-50 focus-visible:ring-stone-400\"\n                />\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"slug\">가게 URL <span className=\"text-red-500\">*</span></Label>\n                <Input\n                  id=\"slug\"\n                  name=\"slug\"\n                  required\n                  value={suggestedSlug}\n                  onChange={(e) => setSuggestedSlug(e.target.value)}\n                  placeholder=\"shop-url\"\n                  className=\"border-stone-200 bg-stone-50 focus-visible:ring-stone-400\"\n                />\n                <p className=\"text-xs text-stone-400\">\n                  고객이 접속할 URL: dongnegage.com/{suggestedSlug || 'your-shop'}\n                </p>\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"phone\">전화번호</Label>\n                <Input\n                  id=\"phone\"\n                  name=\"phone\"\n                  type=\"tel\"\n                  placeholder=\"010-1234-5678\"\n                  className=\"border-stone-200 bg-stone-50 focus-visible:ring-stone-400\"\n                />\n              </div>\n\n              <Button\n                type=\"submit\"\n                disabled={loading}\n                className=\"w-full h-11 bg-stone-900 text-white hover:bg-stone-800\"\n              >\n                {loading ? (\n                  <>\n                    <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                    가입 처리 중...\n                  </>\n                ) : (\n                  '가입하기'\n                )}\n              </Button>\n            </form>\n\n            <p className=\"mt-6 text-center text-sm text-stone-500\">\n              이미 계정이 있으신가요?{' '}\n              <Link href=\"/admin/login\" className=\"font-medium text-stone-900 hover:underline\">\n                로그인\n              </Link>\n            </p>\n          </div>\n        </div>\n      </div>\n    </>\n  )\n}\n"
        }
    ]
}